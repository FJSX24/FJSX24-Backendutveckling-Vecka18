ğŸš€ Workshop Onsdag v.18
Datum: 2025-04-30
Tid: 09.00â€“12.00
Plats: Ordinarie schema
Ã„mne: Databashantering med SQL, PostgreSQL och Express

-----------------------------
ğŸ¯ Syfte

Att fÃ¶rstÃ¥ grunderna i relationsdatabaser (SQL), skillnaden mot NoSQL, samt lÃ¤ra sig grundlÃ¤ggande SQL-syntax fÃ¶r CRUD-operationer. Koppla samman PostgreSQL med Express fÃ¶r att skapa en komplett backendlÃ¶sning.

-----------------------------
âœ… LÃ¤randemÃ¥l

K2: FÃ¶rklara grunderna i databashantering, normalisering och SQL-frÃ¥gor.

F2: Skapa och hantera databaser med hjÃ¤lp av SQL-frÃ¥gor.

-----------------------------
ğŸ§  Agenda

09.00â€“09.10	Intro & dagens mÃ¥l	Introduktion av dagens lektion
09.10â€“09.50	ğŸ¯ Quiz (30-40 min)	FÃ¶rberett quiz â€“ repetition av tidigare kunskap
09.50â€“10.20	ğŸ“š Teori (SQL, SQL vs NoSQL, datamodellering)	PowerPoint och diskussion
10.20â€“10.30	Kort paus â˜•	
10.30â€“11.10	ğŸ’» Code-Along (SQL i pgAdmin)	Skapa DB, tabeller, CRUD
11.10â€“11.45	ğŸ’» Code-Along (Express + SQL)	Koppla PostgreSQL med Express
11.45â€“12.00	ğŸ§© Reflektion & sammanfattning	Diskussion, frÃ¥gor och summering

-----------------------------
Quiz: https://docs.google.com/forms/d/e/1FAIpQLScYtUrwiK6iS0Xv85ayuMP5eDATGBeu97-Q9w5WhhrYxdtEvA/viewform

-----------------------------
ğŸ“š PowerPoint & Talarmanus:

Slide 2 â€“ Vad Ã¤r en databas?
"En databas Ã¤r helt enkelt en organiserad samling data. Den Ã¤r specialiserad pÃ¥ att effektivt lagra, sÃ¶ka, Ã¤ndra och ta bort data â€“ ofta stora mÃ¤ngder information."

-----------------------------
Slide 3: Vad Ã¤r en databas? SQL vs NoSQL
SQL: Strukturerad, tydliga scheman, starka relationer (PostgreSQL, MySQL)

NoSQL: Flexibel struktur, dokumentbaserad, snabbt skalbar (MongoDB, Firestore)

ğŸ—£ï¸ "SQL-databaser Ã¤r bra fÃ¶r strukturerad data med tydliga relationer, medan NoSQL passar bÃ¤ttre fÃ¶r snabbt vÃ¤xande data med flexibel struktur."

-----------------------------
Slide 5: Persistent data
"Persistent data Ã¤r data som lagras permanent och inte fÃ¶rsvinner nÃ¤r servern stÃ¤ngs av. Typiska exempel Ã¤r anvÃ¤ndarinformation, instÃ¤llningar eller inlÃ¤gg och kommentarer."

-----------------------------
-------------------------------------------------
Slide 6 â€“ Vad Ã¤r SQL?
"SQL-databaser organiserar data strikt i tabeller dÃ¤r varje rad har samma struktur. Ett exempel pÃ¥ en SQL-frÃ¥ga Ã¤r: 'SELECT * FROM customers WHERE name = Johan'."

-------------------------------------------------
Slide 7 â€“ Vad Ã¤r NoSQL?
"NoSQL-databaser lagrar data flexibelt, ofta som JSON-dokument. De Ã¤r perfekta nÃ¤r data har varierande struktur eller behÃ¶ver Ã¤ndras ofta under utvecklingen."

-------------------------------------------------
Slide 8 â€“ NoSQL vs Relational (Normalisering)
"Normalisering Ã¤r en process inom SQL dÃ¤r vi undviker att samma data lagras flera gÃ¥nger.  VarfÃ¶r? Jo, fÃ¶r att undvika att samma data finns pÃ¥ flera stÃ¤llen. Duplicering innebÃ¤r Ã¶kad risk fÃ¶r fel, sÃ¤mre prestanda och fÃ¶rsvÃ¥rar underhÃ¥ll."

"Syftet Ã¤r att gÃ¶ra databasen tydlig, snabb och enkel att underhÃ¥lla. Genom att anvÃ¤nda normalisering skapar vi ett effektivt sÃ¤tt att lagra data dÃ¤r varje bit information sparas exakt en gÃ¥ng och Ã¤r lÃ¤tt att uppdatera.

NoSQL tillÃ¥ter tvÃ¤rtom viss duplicering, eftersom flexibilitet ofta Ã¤r viktigare Ã¤n datakonsistens."

Visa och gÃ¥ igenom efterkommande slides 9-13.

ğŸ§© VarfÃ¶r Ã¤r normalisering viktigt?
Undviker redundans (duplicerad data).

GÃ¶r databasen enklare att uppdatera och underhÃ¥lla.

SÃ¤kerstÃ¤ller dataintegritet och minskar risken fÃ¶r inkonsekvenser.

ğŸ—£ï¸ Sammanfattning: Hur anvÃ¤nda detta i praktiken?
"NÃ¤r ni bÃ¶rjar designa databaser, tÃ¤nk alltid pÃ¥ normaliseringsreglerna. StÃ¤ll er sjÃ¤lva frÃ¥gor som: Finns det duplicerad data hÃ¤r? Kan datan organiseras bÃ¤ttre? BehÃ¶ver jag skapa en ny tabell eller en ny relation? DÃ¥ skapar ni en skalbar och tydlig databasstruktur."

-------------------------------------------------
Slide 14 â€“ NoSQL vs Relational (Flexibilitet)
"SQL-databaser krÃ¤ver strikt och ofÃ¶rÃ¤nderlig struktur frÃ¥n bÃ¶rjan. I NoSQL-databaser kan vi dÃ¤remot Ã¤ndra och anpassa datastrukturen kontinuerligt efter projektets behov."

-------------------------------------------------
Slide 15 â€“ NoSQL vs Relational (Skalbarhet)
"NÃ¤r mÃ¤ngden data Ã¶kar kan SQL-databaser bli lÃ¥ngsamma och krÃ¤ver ofta bÃ¤ttre hÃ¥rdvara. NoSQL-databaser dÃ¤remot kan enkelt skalas horisontellt genom att lÃ¤gga till fler servrar, vilket passar bra fÃ¶r stora mÃ¤ngder data, sÃ¥ kallad Big Data."

-------------------------------------------------
Slide 16 â€“ NoSQL vs Relational (Utvecklingsflexibilitet)
"En viktig skillnad Ã¤r utvecklingsflexibiliteten. Med SQL mÃ¥ste du veta exakt vilken data du ska spara redan frÃ¥n bÃ¶rjan, medan NoSQL-databaser lÃ¥ter dig utveckla och Ã¤ndra datamodellen lÃ¶pande under projektets gÃ¥ng. Det ger stor flexibilitet fÃ¶r utvecklaren."

-------------------------------------------------
Slide 17 â€“ Hur ska man tÃ¤nka?
"SÃ¥, hur ska du tÃ¤nka nÃ¤r du modellerar data? BÃ¶rja alltid med att utgÃ¥ frÃ¥n applikationens grÃ¤nssnitt och funktion. Vilken data behÃ¶vs verkligen fÃ¶r att lÃ¶sa problemet? Fundera Ã¶ver sÃ¤kerhet, som kÃ¤nslig data. TÃ¤nk alltid pÃ¥ verkliga objekt och deras egenskaper, sÃ¥ bygger du en logisk och hÃ¥llbar datamodell."

-------------------------------------------------
-------------------------------------------------
-------------------------------------------------
Del 2 - Datamodellering

Slide 19 â€“ Vad Ã¤r en Datamodell?
"En datamodell Ã¤r ett verktyg vi anvÃ¤nder fÃ¶r att organisera och strukturera data. Den visar tydligt hur olika delar av vÃ¥r data hÃ¤nger ihop, och hjÃ¤lper oss att fÃ¶rstÃ¥ relationer mellan objekt, egenskaper och hÃ¤ndelser i verkligheten. MÃ¥let Ã¤r att skapa ordning i komplex information."

-------------------------------------------------
Slide 20 â€“ Utmaningen
"Den stora utmaningen nÃ¤r vi jobbar med datamodellering Ã¤r att verkligheten Ã¤r oerhÃ¶rt komplex. VÃ¥r uppgift blir dÃ¤rfÃ¶r att hitta ett sÃ¤tt att fÃ¶renkla denna komplexitet, sÃ¥ att vi kan lagra och hantera data effektivt."

-------------------------------------------------
Slide 21 â€“ Verkligheten vs Datamodell
"Den hÃ¤r bilden illustrerar ett viktigt koncept: Datamodellen Ã¤r alltid en fÃ¶renkling av verkligheten. Till exempel: en mÃ¤nniska Ã¤r komplex med kÃ¤nslor, tankar, upplevelser och relationer. NÃ¤r vi modellerar detta i en databas kan vi bara fÃ¥nga en liten del â€“ kanske namn, Ã¥lder, adress. Datamodellen Ã¤r alltsÃ¥ aldrig verkligheten sjÃ¤lv, utan bara en avgrÃ¤nsad representation av den."

-------------------------------------------------
Slide 22 â€“ Exempel: Bil
"NÃ¤r vi modellerar data om ett specifikt objekt, till exempel en bil, bÃ¶rjar vi med att fundera Ã¶ver vilka egenskaper som utmÃ¤rker detta objekt. Vilka egenskaper har alla bilar gemensamt? Vad skiljer bilar Ã¥t? Genom att besvara dessa frÃ¥gor kan vi skapa en tydlig modell."

-------------------------------------------------
Slide 23 â€“ Bild (3 olika bilar)
"Titta pÃ¥ dessa tre bilar: en sportbil, en familjebil och en lastbil. De Ã¤r vÃ¤ldigt olika, men vad har de gemensamt? Alla har hjul, ett drivmedel, ett registreringsnummer, och sÃ¥ vidare. Datamodellen fÃ¶r en bil ska fokusera pÃ¥ de egenskaper som alla bilar delar. Det Ã¤r grunden fÃ¶r en hÃ¥llbar och skalbar datamodell."

-------------------------------------------------
Slide 24 â€“ Exempel pÃ¥ Bil-objekt
"HÃ¤r Ã¤r ett konkret exempel pÃ¥ ett bil-objekt i JavaScript. Vi har valt nÃ¥gra grundlÃ¤ggande egenskaper som antal hjul och brÃ¤nsletyp. FrÃ¥gan vi bÃ¶r stÃ¤lla oss Ã¤r alltid: Ã„r alla egenskaper relevanta att spara? BehÃ¶ver vi verkligen lagra om bilen har en ratt, eller Ã¤r det sjÃ¤lvklart?"

-------------------------------------------------
Slide 25 â€“ Ã–vning (Cykel-objekt)
"Nu fÃ¥r ni testa sjÃ¤lva: Fundera Ã¶ver vilka egenskaper som kÃ¤nnetecknar en cykel. Vad Ã¤r gemensamt fÃ¶r alla cyklar? Vilka egenskaper skiljer olika cyklar Ã¥t? Detta Ã¤r kÃ¤rnan i att skapa en effektiv datamodell."

-------------------------------------------------
Slide 26 â€“ I vilken form kommer data?
"Data kommer i flera olika format som text, nummer, objekt, arrayer, booleans och binÃ¤rt format som bilder eller filer. Vilken form data har pÃ¥verkar hur vi sparar och hanterar den."

-------------------------------------------------
Slide 27 â€“ Hur ska data sparas?
"Hur vi sparar data beror pÃ¥ komplexiteten. Enkel data kan sparas i listor eller tabeller, medan mer komplex data ofta krÃ¤ver dokumentformat eller relationer mellan tabeller eller dokument."
-------------------------------------------------
Slide 28 â€“ Repetition!!!!!! Hur ska man tÃ¤nka?
"SÃ¥, hur ska du tÃ¤nka nÃ¤r du modellerar data? BÃ¶rja alltid med att utgÃ¥ frÃ¥n applikationens grÃ¤nssnitt och funktion. Vilken data behÃ¶vs verkligen fÃ¶r att lÃ¶sa problemet? Fundera Ã¶ver sÃ¤kerhet, som kÃ¤nslig data. TÃ¤nk alltid pÃ¥ verkliga objekt och deras egenskaper, sÃ¥ bygger du en logisk och hÃ¥llbar datamodell."

-----------------------------
-----------------------------
-----------------------------
ğŸ’» Code-Along

ğŸ¯ Ã–vergripande mÃ¥l
Efter lektionen ska eleverna kunna:

FÃ¶rklara varfÃ¶r tabeller och kolumner anvÃ¤nds.

FÃ¶rstÃ¥ och utfÃ¶ra grundlÃ¤ggande CRUD-operationer i SQL.

Beskriva vad relationer och foreign keys innebÃ¤r.

AnvÃ¤nda JOIN fÃ¶r att kombinera data frÃ¥n flera tabeller.

-----------------------------
Del 1 â€“ SQL i pgAdmin 

1. Starta pgAdmin och skapa en ny databas
Ã–ppna pgAdmin och anslut till din lokala PostgreSQL.

HÃ¶gerklicka pÃ¥ Databases â†’ Create â†’ Database

Namnge databasen testdb

ğŸ“š Viktiga extra begrepp du kan lyfta i diskussion
SERIAL (auto-increment id)

VARCHAR (maxlÃ¤ngd pÃ¥ text)

INTEGER (heltal)

PRIMARY KEY (unik identifierare)

FOREIGN KEY (relation mellan tabeller)

JOIN (kombinera flera tabeller)

Pool frÃ¥n pg (effektiv hantering av anslutningar)

-----------------------------
2. Skapa tabeller

ğŸ“– FÃ¶rklaring & syfte
Varje databas bestÃ¥r av tabeller.
En tabell innehÃ¥ller kolumner och rader (data).

Exempel: En tabell fÃ¶r anvÃ¤ndare (users) kan innehÃ¥lla:

id fÃ¶r att identifiera varje anvÃ¤ndare unikt.

name fÃ¶r anvÃ¤ndarens namn.

email fÃ¶r kontaktuppgifter.

ğŸ—£ï¸ Talarmanus:
"VarfÃ¶r behÃ¶ver vi tabeller och kolumner?
TÃ¤nk er en Excel-fil med flera blad. Varje blad motsvarar en tabell i databasen, och varje kolumn definierar vad som sparas, t.ex. namn eller e-post. Varje rad Ã¤r en enskild anvÃ¤ndare."

HÃ¶gerklicka pÃ¥ testdb â†’ Query Tool fÃ¶r att Ã¶ppna SQL-skrivverktyget.

KÃ¶r fÃ¶ljande kod fÃ¶r att skapa tabellen users:
CREATE TABLE users (
  id SERIAL PRIMARY KEY,
  name VARCHAR(50),
  email VARCHAR(50)
);

KÃ¶r SQL-queryn med F5-knappen eller Execute (â©).

"HÃ¤r skapar vi vÃ¥r fÃ¶rsta tabell (users) med tre kolumner."
-----------------------------
3. GrundlÃ¤ggande SQL-queries (CRUD)

Operation	SQL Keyword	FÃ¶rklaring
Create	INSERT	LÃ¤gg till data
Read	SELECT	HÃ¤mta data
Update	UPDATE	Ã„ndra befintlig data
Delete	DELETE	Ta bort data

ğŸ“Œ INSERT (LÃ¤gg till data)
INSERT INTO users (name, email) VALUES ('Anna', 'anna@test.se');
INSERT INTO products (name, price) VALUES ('Laptop', 12000);

ğŸ“Œ SELECT (LÃ¤s data)
SELECT * FROM users;
SELECT name, price FROM products;

ğŸ“Œ UPDATE (Uppdatera data)
UPDATE users SET name='Anna Svensson' WHERE id=1;
UPDATE products SET price=10000 WHERE id=1;

ğŸ“Œ DELETE (Ta bort data)
DELETE FROM users WHERE id=1;
DELETE FROM products WHERE id=1;

-----------------------------
ğŸ”— Del 4: Relationshantering (Foreign keys)

ğŸ“– FÃ¶rklaring & syfte
Relationsdatabaser anvÃ¤nder nycklar (keys) fÃ¶r att koppla ihop data frÃ¥n olika tabeller.

Primary key: Unik identifierare fÃ¶r varje rad.

Foreign key: HÃ¤nvisning till primary key i en annan tabell.

ğŸ—£ï¸ Talarmanus:
"VarfÃ¶r relationer?
FÃ¶restÃ¤ll er att vi har anvÃ¤ndare och deras produkter. Vi vill veta vem som Ã¤ger vilken produkt. Med en foreign key kan vi koppla produkten till anvÃ¤ndaren utan att duplicera anvÃ¤ndardata."

âš™ï¸ Execute:
Skapa tabellen products:
CREATE TABLE products (
  id SERIAL PRIMARY KEY,
  name VARCHAR(50),
  price INTEGER
);

"HÃ¤r skapade vi tabellen products med en foreign key (user_id) som pekar pÃ¥ anvÃ¤ndarnas id."

Nu har vi anvÃ¤ndare och produkter, men hur kopplar vi ihop dem? Vi gÃ¶r detta genom att lÃ¤gga till en sÃ¥ kallad foreign key. Det betyder att varje produkt kan kopplas till en anvÃ¤ndare.

âš™ï¸ Execute stegvis i pgAdmin:
ALTER TABLE products ADD COLUMN user_id INTEGER;
ALTER TABLE products ADD FOREIGN KEY (user_id) REFERENCES users(id);

FÃ¶rsta raden lÃ¤gger till en ny kolumn (user_id).

Andra raden definierar relationen dÃ¤r varje produkt hÃ¤nvisar till ett anvÃ¤ndar-id.

-----------------------------
5. Skapa relationer mellan tabeller (JOIN-exempel)

JOIN anvÃ¤nds fÃ¶r att kombinera data frÃ¥n flera tabeller.

Typ av JOIN	Beskrivning
INNER JOIN	Visar rader dÃ¤r bÃ¥da tabeller matchar.
LEFT JOIN	Visar alla rader frÃ¥n vÃ¤nster tabell.
RIGHT JOIN	Visar alla rader frÃ¥n hÃ¶ger tabell.

"VarfÃ¶r anvÃ¤nder vi JOIN? Om vi har data i olika tabeller och vill visa dem ihop, som produkter med deras Ã¤gares namn, behÃ¶ver vi en JOIN."

âš™ï¸ Execute JOIN-query (INNER JOIN):
SELECT products.name, products.price, users.name AS owner
FROM products
JOIN users ON products.user_id = users.id;

"Denna JOIN visar alla produkter och vem som Ã¤ger dem."

-----------------------------
-----------------------------
-----------------------------
Code-Along Del 2 â€“ Koppla PostgreSQL med Express

Nu vill vi anvÃ¤nda databasen frÃ¥n vÃ¥r backend (Express). Vi anvÃ¤nder paketet pg som lÃ¥ter oss koppla Node.js till PostgreSQL.

"Hur kopplar vi ihop Express och PostgreSQL? Vi anvÃ¤nder paketet 'pg' som mÃ¶jliggÃ¶r att kÃ¶ra SQL frÃ¥n JavaScript."

1. FÃ¶rbered Express-projektet

I terminalen:
npm init -y
npm install express pg

2. Skapa index.js och koppla till PostgreSQL

Skapa filen index.js:

GenomfÃ¶r den koden

-----------------------------
Testa endpoints i Postman eller Insomnia.

Starta Express-appen:
node index.js

Testa med Postman eller Insomnia:

GET: http://localhost:3000/users

POST: http://localhost:3000/users med JSON-body:
{
  "name": "Lisa",
  "email": "lisa@test.se"
}

-----------------------------
-----------------------------
-----------------------------
Dags fÃ¶r Ã¶vningar

-----------------------------
-----------------------------
-----------------------------
ğŸ” Gruppdiskussion 

Vilka utmaningar mÃ¶tte ni med SQL-syntax?

Hur skiljer sig SQL- och NoSQL-databaser i praktiken?

Hur ser ni pÃ¥ databasstruktur i ert Chas Challenge-projekt?

Vad Ã¤r fÃ¶rdelen med SQL jÃ¤mfÃ¶rt med NoSQL?

Vad tycker ni Ã¤r svÃ¥rast med SQL-syntax?

VarfÃ¶r Ã¤r det viktigt med felhantering vid databasoperationer?